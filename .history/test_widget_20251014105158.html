<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Widget Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background 0.3s;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .feature-list li:before {
            content: "âœ“ ";
            color: #28a745;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸ¤– Chatbot Widget Testing Guide</h1>
        
        <div class="test-section">
            <h2>ðŸ“‹ Test Overview</h2>
            <p>This page helps you test the jewellery chatbot widget functionality. The widget should appear in the bottom-right corner of this page.</p>
            
            <div id="widget-status" class="status info">
                Checking widget status...
            </div>
        </div>

        <div class="test-section">
            <h2>ðŸŽ¯ Quick Tests</h2>
            <p>Click these buttons to test different widget features:</p>
            
            <button class="test-button" onclick="testWidgetOpen()">Open Widget</button>
            <button class="test-button" onclick="testWidgetClose()">Close Widget</button>
            <button class="test-button" onclick="testJewelryQuery()">Test Jewelry Query</button>
            <button class="test-button" onclick="testJewellrySpelling()">Test "Jewellry" Spelling</button>
            <button class="test-button" onclick="testAuthentication()">Test Authentication</button>
            <button class="test-button" onclick="testThemeChange()">Change Theme</button>
        </div>

        <div class="test-section">
            <h2>ðŸ’¬ Sample Jewelry Queries</h2>
            <p>Test these specific queries to verify widget functionality:</p>
            
            <button class="test-button" onclick="sendQuery('Show me gold rings under $500')">Gold Rings &lt; $500</button>
            <button class="test-button" onclick="sendQuery('What necklaces would look good with a black dress?')">Necklaces for Black Dress</button>
            <button class="test-button" onclick="sendQuery('I need a gift for my wife\'s birthday')">Birthday Gift Ideas</button>
            <button class="test-button" onclick="sendQuery('Show me jewellry')">Test "Jewellry" Spelling</button>
            <button class="test-button" onclick="sendQuery('What jewellery do you have?')">General Jewelry Query</button>
        </div>

        <div class="test-section">
            <h2>ðŸ“Š Test Results</h2>
            <div id="test-results">
                <p>Test results will appear here...</p>
            </div>
        </div>

        <div class="test-section">
            <h2>âœ… Features to Test</h2>
            <ul class="feature-list">
                <li>Widget opens and closes properly</li>
                <li>Authentication (login/signup) works</li>
                <li>Jewelry product search returns results</li>
                <li>"Jewellry" spelling correction works</li>
                <li>Chat history is maintained</li>
                <li>Widget themes can be changed</li>
                <li>Widget position can be adjusted</li>
                <li>File upload functionality (if implemented)</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>ðŸ”§ Manual Testing Steps</h2>
            <ol>
                <li><strong>Visual Check:</strong> Verify widget button appears in bottom-right corner</li>
                <li><strong>Open/Close:</strong> Click the chat button to open/close the widget</li>
                <li><strong>Authentication:</strong> Try logging in with test credentials</li>
                <li><strong>Query Testing:</strong> Type jewelry-related questions</li>
                <li><strong>Spelling Test:</strong> Specifically test "jewellry" spelling</li>
                <li><strong>Response Check:</strong> Verify responses contain relevant products</li>
                <li><strong>Theme Testing:</strong> Change widget appearance</li>
                <li><strong>Position Testing:</strong> Move widget to different corners</li>
            </ol>
        </div>
    </div>

    <!-- Load the chatbot widget -->
    <script src="jewellery-chatbot-widget.js"></script>
    
    <script>
        // Initialize the chatbot widget
        window.JewelleryChatbot.init({
            apiUrl: 'http://localhost:8000',
            position: 'bottom-right',
            theme: 'blue',
            welcomeMessage: 'Welcome to the Widget Test Page! ðŸ’Ž I\'m here to help you find the perfect jewellery. Try the test buttons above or ask me anything!',
            placeholderText: 'Ask about jewellery, test spelling, try queries...',
            autoOpen: false
        });

        // Test functions
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('widget-status');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
        }

        function addTestResult(message, type = 'info') {
            const resultsDiv = document.getElementById('test-results');
            const resultItem = document.createElement('div');
            resultItem.className = `status ${type}`;
            resultItem.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            resultsDiv.appendChild(resultItem);
        }

        function testWidgetOpen() {
            try {
                window.JewelleryChatbot.open();
                updateStatus('Widget opened successfully', 'success');
                addTestResult('Widget opened successfully', 'success');
            } catch (error) {
                updateStatus('Failed to open widget: ' + error.message, 'error');
                addTestResult('Failed to open widget: ' + error.message, 'error');
            }
        }

        function testWidgetClose() {
            try {
                window.JewelleryChatbot.close();
                updateStatus('Widget closed successfully', 'success');
                addTestResult('Widget closed successfully', 'success');
            } catch (error) {
                updateStatus('Failed to close widget: ' + error.message, 'error');
                addTestResult('Failed to close widget: ' + error.message, 'error');
            }
        }

        function testJewelryQuery() {
            sendQuery('Show me some jewelry');
        }

        function testJewellrySpelling() {
            sendQuery('Show me jewellry');
        }

        function testAuthentication() {
            try {
                window.JewelleryChatbot.open();
                setTimeout(() => {
                    // Try to authenticate with test credentials
                    window.JewelleryChatbot.send('/login test_user_02ff81cd test123');
                    updateStatus('Authentication test initiated', 'info');
                    addTestResult('Authentication test initiated', 'info');
                }, 1000);
            } catch (error) {
                updateStatus('Authentication test failed: ' + error.message, 'error');
                addTestResult('Authentication test failed: ' + error.message, 'error');
            }
        }

        function testThemeChange() {
            try {
                const themes = ['blue', 'purple', 'green'];
                const currentTheme = themes[Math.floor(Math.random() * themes.length)];
                window.JewelleryChatbot.setTheme(currentTheme);
                updateStatus(`Theme changed to ${currentTheme}`, 'success');
                addTestResult(`Theme changed to ${currentTheme}`, 'success');
            } catch (error) {
                updateStatus('Theme change failed: ' + error.message, 'error');
                addTestResult('Theme change failed: ' + error.message, 'error');
            }
        }

        function sendQuery(query) {
            try {
                window.JewelleryChatbot.open();
                setTimeout(() => {
                    window.JewelleryChatbot.send(query);
                    updateStatus(`Sent query: "${query}"`, 'info');
                    addTestResult(`Sent query: "${query}"`, 'info');
                }, 500);
            } catch (error) {
                updateStatus('Failed to send query: ' + error.message, 'error');
                addTestResult('Failed to send query: ' + error.message, 'error');
            }
        }

        // Check widget status on page load
        window.addEventListener('load', function() {
            setTimeout(() => {
                if (typeof window.JewelleryChatbot !== 'undefined') {
                    updateStatus('Widget loaded and ready for testing', 'success');
                    addTestResult('Widget loaded successfully', 'success');
                } else {
                    updateStatus('Widget failed to load - check console for errors', 'error');
                    addTestResult('Widget failed to load', 'error');
                }
            }, 2000);
        });
    </script>
</body>
</html>